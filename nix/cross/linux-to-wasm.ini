# Meson cross-compilation file for Linux to WebAssembly (Emscripten)
# Usage: meson setup builddir --cross-file cross/linux-to-wasm.ini
#
# Prerequisites:
# - Install Emscripten SDK: https://emscripten.org/docs/getting_started/downloads.html
# - Source emsdk environment: source /path/to/emsdk/emsdk_env.sh

[binaries]
c = 'emcc'
cpp = 'em++'
ar = 'emar'
strip = 'emstrip'

[host_machine]
system = 'emscripten'
cpu_family = 'wasm32'
cpu = 'wasm32'
endian = 'little'

# Compiler flags:
# ---------------
# -g3: Include debug information (handled in meson.build for wasm debug builds)
# -sUSE_SDL=3: Use SDL 3 for graphics and input
# -sUSE_PTHREADS=1: Enable pthreads support for multithreading
# -sNO_DISABLE_EXCEPTION_CATCHING: Keep exception catching enabled for better error handling

# Linker flags:
# -------------
# -sWASM=1: Generate WebAssembly output
# -sALLOW_MEMORY_GROWTH=1: Allow memory to grow dynamically
# -sASSERTIONS=1: Enable runtime assertions for debugging
# -sASYNCIFY=1: Enable Asyncify for asynchronous operations
# -sUSE_WEBGL2=1: Use WebGL 2 for graphics rendering
# -sMIN_WEBGL_VERSION=2: Set minimum WebGL version to 2
# -sMAX_WEBGL_VERSION=2: Set maximum WebGL version to 2

[built-in options]
cpp_args = ['-sUSE_PTHREADS=0', '-sNO_DISABLE_EXCEPTION_CATCHING']
cpp_link_args = ['-sUSE_PTHREADS=0', '-sWASM=1', '-sALLOW_MEMORY_GROWTH=1']

; cpp_args = ['-sUSE_SDL=3', '-sUSE_PTHREADS=1', '-sNO_DISABLE_EXCEPTION_CATCHING']
; cpp_link_args = ['-sWASM=1', '-sALLOW_MEMORY_GROWTH=1', '-sASSERTIONS=1', '-sASYNCIFY=1', '-sUSE_WEBGL2=1', '-sMIN_WEBGL_VERSION=2', '-sMAX_WEBGL_VERSION=2', '-sNO_DISABLE_EXCEPTION_CATCHING', '-sUSE_SDL=3', '-sUSE_PTHREADS=1']
